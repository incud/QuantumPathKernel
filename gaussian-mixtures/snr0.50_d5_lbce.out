Welcome
specs_1.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_2.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_3.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_4.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_5.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_6.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_7.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_8.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_9.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_10.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_11.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_12.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_13.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_14.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_15.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_16.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_17.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_18.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_19.json already contains a testing set! The new instructions are ignored. The old set is kept
specs_20.json already contains a testing set! The new instructions are ignored. The old set is kept


05/04/2022 08:56:25 - Testing wrt file specs_1.json
05/04/2022 08:56:25 - Loss (bce) for variational model: 1.0098048
05/04/2022 08:56:27 - Start NTK PK calculation
05/04/2022 08:57:13 - End


05/04/2022 08:57:13 - Testing wrt file specs_2.json
05/04/2022 08:57:13 - Loss (bce) for variational model: 1.023454
05/04/2022 08:57:14 - Start NTK PK calculation
05/04/2022 09:01:12 - End


05/04/2022 09:01:12 - Testing wrt file specs_3.json
05/04/2022 09:01:12 - Loss (bce) for variational model: 0.9604916
05/04/2022 09:01:13 - Start NTK PK calculation
05/04/2022 09:09:27 - End


05/04/2022 09:09:27 - Testing wrt file specs_4.json
05/04/2022 09:09:27 - Loss (bce) for variational model: 0.9681728
05/04/2022 09:09:28 - Start NTK PK calculation
05/04/2022 09:22:58 - End


05/04/2022 09:22:58 - Testing wrt file specs_5.json
05/04/2022 09:22:58 - Loss (bce) for variational model: 0.97517776
05/04/2022 09:23:00 - Start NTK PK calculation
05/04/2022 09:33:43 - End


05/04/2022 09:33:43 - Testing wrt file specs_6.json
05/04/2022 09:33:43 - Loss (bce) for variational model: 0.9661766
05/04/2022 09:33:45 - Start NTK PK calculation
05/04/2022 09:59:17 - End


05/04/2022 09:59:17 - Testing wrt file specs_7.json
05/04/2022 09:59:17 - Loss (bce) for variational model: 1.018243
05/04/2022 09:59:19 - Start NTK PK calculation
05/04/2022 10:24:42 - End


05/04/2022 10:24:42 - Testing wrt file specs_8.json
05/04/2022 10:24:42 - Loss (bce) for variational model: 0.9922089
05/04/2022 10:24:44 - Start NTK PK calculation
05/04/2022 10:55:30 - End


05/04/2022 10:55:30 - Testing wrt file specs_9.json
05/04/2022 10:55:30 - Loss (bce) for variational model: 0.96278256
05/04/2022 10:55:33 - Start NTK PK calculation
05/04/2022 11:30:45 - End


05/04/2022 11:30:45 - Testing wrt file specs_10.json
05/04/2022 11:30:45 - Loss (bce) for variational model: 0.9287834
05/04/2022 11:30:48 - Start NTK PK calculation
05/04/2022 11:59:54 - End


05/04/2022 11:59:54 - Testing wrt file specs_11.json
05/04/2022 11:59:54 - Loss (bce) for variational model: 0.9750851
05/04/2022 11:59:57 - Start NTK PK calculation
05/04/2022 12:34:48 - End


05/04/2022 12:34:48 - Testing wrt file specs_12.json
05/04/2022 12:34:48 - Loss (bce) for variational model: 0.9585471
05/04/2022 12:34:51 - Start NTK PK calculation
05/04/2022 13:11:13 - End


05/04/2022 13:11:13 - Testing wrt file specs_13.json
05/04/2022 13:11:13 - Loss (bce) for variational model: 1.008972
05/04/2022 13:11:17 - Start NTK PK calculation
05/04/2022 13:46:48 - End


05/04/2022 13:46:48 - Testing wrt file specs_14.json
05/04/2022 13:46:48 - Loss (bce) for variational model: 0.99359053
05/04/2022 13:46:52 - Start NTK PK calculation
05/04/2022 14:21:06 - End


05/04/2022 14:21:06 - Testing wrt file specs_15.json
05/04/2022 14:21:06 - Loss (bce) for variational model: 0.9638824
05/04/2022 14:21:10 - Start NTK PK calculation
05/04/2022 15:38:04 - End


05/04/2022 15:38:04 - Testing wrt file specs_16.json
05/04/2022 15:38:04 - Loss (bce) for variational model: 0.9045255
05/04/2022 15:38:09 - Start NTK PK calculation
05/04/2022 16:29:13 - End


05/04/2022 16:29:13 - Testing wrt file specs_17.json
05/04/2022 16:29:13 - Loss (bce) for variational model: 0.9600821
05/04/2022 16:29:17 - Start NTK PK calculation
05/04/2022 17:11:23 - End


05/04/2022 17:11:23 - Testing wrt file specs_18.json
05/04/2022 17:11:23 - Loss (bce) for variational model: 0.83457863
05/04/2022 17:11:28 - Start NTK PK calculation
05/04/2022 17:57:21 - End


05/04/2022 17:57:21 - Testing wrt file specs_19.json
05/04/2022 17:57:21 - Loss (bce) for variational model: 0.90513784
2022-04-05 17:57:35.492336: E external/org_tensorflow/tensorflow/compiler/xla/pjrt/pjrt_stream_executor_client.cc:2140] Execution of replica 0 failed: INTERNAL: Failed to load in-memory CUBIN: CUDA_ERROR_OUT_OF_MEMORY: out of memory
05/04/2022 17:57:27 - Start NTK PK calculation
Traceback (most recent call last):
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 895, in <module>
    main()
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1128, in __call__
    return self.main(*args, **kwargs)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1053, in main
    rv = self.invoke(ctx)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1659, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1395, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 754, in invoke
    return __callback(*args, **kwargs)
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 880, in test
    run_test(directory, regenerate, m)
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 238, in run_test
    ntk_test_grams, ntk_test_gram_indexes = calculate_ntk(X_train, qnn, trace_df, X_test=X_test)
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 144, in calculate_ntk
    ntk_gram = kernel_matrix(X, X_test, kernel=lambda x1, x2: ntk(x1, x2, params))
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/pennylane/kernels/utils.py", line 120, in kernel_matrix
    matrix[M * i + j] = kernel(X1[i], X2[j])
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 144, in <lambda>
    ntk_gram = kernel_matrix(X, X_test, kernel=lambda x1, x2: ntk(x1, x2, params))
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 130, in ntk
    a = jnp.array(qnn_grad(x1, params))
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/api.py", line 876, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/api.py", line 952, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/api.py", line 2408, in _vjp
    out_primal, out_vjp = ad.vjp(
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/interpreters/ad.py", line 119, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/interpreters/ad.py", line 106, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr(jvpfun_flat, in_pvals)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 592, in trace_to_jaxpr
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/linear_util.py", line 166, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/api.py", line 432, in cache_miss
    out_flat = xla.xla_call(
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/core.py", line 1709, in bind
    return call_bind(self, fun, *args, **params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/core.py", line 1721, in call_bind
    outs = top_trace.process_call(primitive, fun, tracers, params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/interpreters/ad.py", line 331, in process_call
    result = call_primitive.bind(f_jvp, *primals, *nonzero_tangents, **new_params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/core.py", line 1709, in bind
    return call_bind(self, fun, *args, **params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/core.py", line 1721, in call_bind
    outs = top_trace.process_call(primitive, fun, tracers, params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 207, in process_call
    out = primitive.bind(f, *in_consts, **const_params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/core.py", line 1709, in bind
    return call_bind(self, fun, *args, **params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/core.py", line 1721, in call_bind
    outs = top_trace.process_call(primitive, fun, tracers, params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/core.py", line 614, in process_call
    return primitive.impl(f, *tracers, **params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/dispatch.py", line 145, in _xla_call_impl
    out = compiled_fun(*args)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/jax/_src/dispatch.py", line 444, in _execute_compiled
    out_bufs = compiled.execute(input_bufs)
jax._src.traceback_util.UnfilteredStackTrace: RuntimeError: INTERNAL: Failed to load in-memory CUBIN: CUDA_ERROR_OUT_OF_MEMORY: out of memory

The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.

--------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 895, in <module>
    main()
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1128, in __call__
    return self.main(*args, **kwargs)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1053, in main
    rv = self.invoke(ctx)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1659, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 1395, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/click/core.py", line 754, in invoke
    return __callback(*args, **kwargs)
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 880, in test
    run_test(directory, regenerate, m)
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 238, in run_test
    ntk_test_grams, ntk_test_gram_indexes = calculate_ntk(X_train, qnn, trace_df, X_test=X_test)
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 144, in calculate_ntk
    ntk_gram = kernel_matrix(X, X_test, kernel=lambda x1, x2: ntk(x1, x2, params))
  File "/data/mgrossi/anaconda_install/envs/pennylane/lib/python3.9/site-packages/pennylane/kernels/utils.py", line 120, in kernel_matrix
    matrix[M * i + j] = kernel(X1[i], X2[j])
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 144, in <lambda>
    ntk_gram = kernel_matrix(X, X_test, kernel=lambda x1, x2: ntk(x1, x2, params))
  File "/data/mgrossi/QuantumPathKernel/gaussian-mixtures/gaussian-mixture-jax.py", line 130, in ntk
    a = jnp.array(qnn_grad(x1, params))
RuntimeError: INTERNAL: Failed to load in-memory CUBIN: CUDA_ERROR_OUT_OF_MEMORY: out of memory
